# 实验管理功能测试计划

本文档详细描述了如何测试 DeSciData 平台的实验管理功能，确保研究者能够创建、管理实验，以及用户能够浏览和访问这些实验。

## 测试前提

- 已部署 DeSciData 智能合约
- 前端服务器正在运行
- 准备了测试账户（研究者、普通用户）
- 每个钱包中有足够的测试 ETH

## 测试用例

### 1. 实验创建功能测试

#### 1.1 基本实验创建

**目标**: 验证研究者能够创建基本实验

**步骤**:
1. 使用研究者账户登录
2. 访问 `http://localhost:3000/dashboard`
3. 点击"创建实验"按钮
4. 在表单中填写：
   - 标题: "基因组数据分析方法"
   - 描述: "使用机器学习技术分析人类基因组数据的新方法"
   - 标签: "基因组学", "机器学习", "数据分析"
   - 上传一个示例图片作为封面
5. 提交表单
6. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 新创建的实验应出现在研究者的项目列表中
- [ ] 实验详情应正确显示所有输入的信息
- [ ] 封面图片应正确上传和显示

#### 1.2 带资金目标的实验创建

**目标**: 验证研究者能够创建带资金目标的实验

**步骤**:
1. 使用研究者账户登录
2. 访问 `http://localhost:3000/dashboard`
3. 点击"创建实验"按钮
4. 在表单中填写基本信息，并额外填写：
   - 资金目标: 5 ETH
   - 截止日期: 当前日期 + 30 天
   - 资金用途说明: "资金将用于购买计算资源和数据存储"
5. 提交表单
6. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 新创建的实验应出现在研究者的项目列表和众筹页面中
- [ ] 实验详情应显示资金目标、当前资金（0 ETH）和截止日期
- [ ] 应显示资金进度条，初始为 0%

#### 1.3 带数据集的实验创建

**目标**: 验证研究者能够创建包含数据集的实验

**步骤**:
1. 使用研究者账户登录
2. 访问 `http://localhost:3000/dashboard`
3. 点击"创建实验"按钮
4. 在表单中填写基本信息，并额外填写：
   - 数据集名称: "匿名化基因组数据集"
   - 数据集描述: "包含 1000 个匿名化的人类基因组样本"
   - 上传一个小型示例数据文件
   - 数据格式: "CSV, JSON"
   - 数据大小: "2.5 GB"
   - 数据访问价格: 0.1 ETH
5. 提交表单
6. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 新创建的实验应出现在研究者的项目列表中
- [ ] 实验详情应显示数据集信息
- [ ] 数据访问价格应正确显示
- [ ] 示例数据文件应可下载

### 2. 实验管理功能测试

#### 2.1 编辑实验信息

**目标**: 验证研究者能够编辑已创建的实验信息

**步骤**:
1. 使用研究者账户登录
2. 访问 `http://localhost:3000/dashboard/projects`
3. 从项目列表中选择一个实验
4. 点击"编辑"按钮
5. 修改以下信息：
   - 描述: 添加额外的研究方法说明
   - 标签: 添加一个新标签 "健康信息学"
6. 提交更改
7. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 实验详情应更新为新的信息
- [ ] 只有可编辑的字段应允许修改（如标题可能不允许修改）
- [ ] 更新历史应记录此次更改

#### 2.2 添加实验结果

**目标**: 验证研究者能够向实验添加研究结果

**步骤**:
1. 使用研究者账户登录
2. 访问一个已创建的实验详情页面
3. 找到"添加研究结果"部分并点击
4. 在表单中填写：
   - 结果标题: "初步数据分析结果"
   - 结果描述: "使用聚类算法对基因组数据进行的初步分析"
   - 上传一个结果文件或图表
   - 结果日期: 当前日期
5. 提交表单
6. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 研究结果应出现在实验详情页面的结果部分
- [ ] 结果文件或图表应可查看
- [ ] 结果应按日期排序

#### 2.3 管理数据访问权限

**目标**: 验证研究者能够管理谁可以访问实验数据

**步骤**:
1. 使用研究者账户登录
2. 访问一个包含数据集的实验详情页面
3. 找到"数据访问管理"部分并点击
4. 查看已购买访问权的用户列表
5. 尝试手动授予一个测试账户的访问权限
6. 提交更改
7. 在 MetaMask 中确认交易

**验证点**:
- [ ] 应显示已购买访问权的用户列表
- [ ] 手动授权功能应正常工作
- [ ] 交易成功后，被授权的账户应出现在访问列表中
- [ ] 被授权的账户应能够访问数据集

### 3. 实验浏览功能测试

#### 3.1 实验列表浏览

**目标**: 验证用户能够浏览所有公开的实验

**步骤**:
1. 使用任意账户或不登录
2. 访问 `http://localhost:3000/experiments`
3. 浏览实验列表
4. 测试筛选和排序功能：
   - 按标签筛选
   - 按创建日期排序
   - 按资金状态筛选

**验证点**:
- [ ] 页面应显示所有公开的实验
- [ ] 每个实验卡片应显示基本信息（标题、描述摘要、标签、资金状态）
- [ ] 筛选功能应正确工作，只显示符合条件的实验
- [ ] 排序功能应正确工作，按选定的顺序排列实验
- [ ] 分页功能应正常工作（如果有多页实验）

#### 3.2 实验搜索功能

**目标**: 验证用户能够搜索实验

**步骤**:
1. 访问 `http://localhost:3000/experiments`
2. 在搜索框中输入关键词（如"基因组"）
3. 提交搜索
4. 查看搜索结果

**验证点**:
- [ ] 搜索应返回包含关键词的实验
- [ ] 搜索应检查标题、描述和标签
- [ ] 如果没有匹配结果，应显示适当的空状态提示
- [ ] 搜索结果应可以进一步筛选和排序

#### 3.3 实验详情页面

**目标**: 验证用户能够查看实验的详细信息

**步骤**:
1. 从实验列表中选择一个实验
2. 点击查看详情
3. 浏览实验详情页面的各个部分

**验证点**:
- [ ] 页面应显示完整的实验信息
- [ ] 应显示研究者信息和联系方式
- [ ] 如果有资金目标，应显示资金进度
- [ ] 如果有数据集，应显示数据集信息和访问选项
- [ ] 如果有研究结果，应显示结果列表
- [ ] 页面应有适当的操作按钮（如"支持此研究"、"购买数据访问权"）

### 4. 数据访问功能测试

#### 4.1 购买数据访问权

**目标**: 验证用户能够购买实验数据的访问权

**步骤**:
1. 使用普通用户账户登录
2. 访问一个包含付费数据集的实验详情页面
3. 点击"购买数据访问权"按钮
4. 在弹出的模态框中确认购买
5. 在 MetaMask 中确认交易

**验证点**:
- [ ] 模态框应显示数据集信息和价格
- [ ] 交易成功后应显示确认消息
- [ ] 用户应被添加到有权访问数据的用户列表中
- [ ] 用户应能够下载或查看数据集
- [ ] 交易应记录在用户的购买历史中

#### 4.2 访问已购买的数据

**目标**: 验证用户能够访问已购买的数据集

**步骤**:
1. 使用已购买数据访问权的账户登录
2. 访问 `http://localhost:3000/portfolio`
3. 找到已购买的数据集并点击
4. 尝试下载或查看数据

**验证点**:
- [ ] 用户的投资组合应显示已购买的数据集
- [ ] 用户应能够成功下载或查看数据
- [ ] 如果数据存储在 IPFS 上，应能正确获取
- [ ] 数据应以原始格式提供，不应有损坏

#### 4.3 数据 NFT 验证

**目标**: 验证购买数据访问权后是否正确铸造数据 NFT

**步骤**:
1. 使用已购买数据访问权的账户登录
2. 访问 `http://localhost:3000/portfolio`
3. 查看 NFT 部分
4. 检查与购买的数据集相关的 NFT

**验证点**:
- [ ] 应显示与购买的数据集相关的 NFT
- [ ] NFT 元数据应包含正确的数据集信息
- [ ] NFT 应可在区块链浏览器中验证
- [ ] NFT 应与用户的钱包地址关联

### 5. 实验统计与分析功能测试

#### 5.1 研究者仪表板统计

**目标**: 验证研究者能够查看其实验的统计数据

**步骤**:
1. 使用研究者账户登录
2. 访问 `http://localhost:3000/dashboard`
3. 查看统计部分

**验证点**:
- [ ] 应显示实验总数
- [ ] 应显示总资金筹集金额
- [ ] 应显示数据集销售统计
- [ ] 应显示访问者和引用统计
- [ ] 统计应有可视化图表（如折线图、饼图）

#### 5.2 单个实验分析

**目标**: 验证研究者能够查看单个实验的详细分析

**步骤**:
1. 使用研究者账户登录
2. 访问 `http://localhost:3000/dashboard/projects/[实验ID]`
3. 查看分析部分

**验证点**:
- [ ] 应显示访问者统计（总数、独立访问者）
- [ ] 应显示资金统计（如适用）
- [ ] 应显示数据访问统计
- [ ] 应显示引用统计
- [ ] 应有时间趋势图表
- [ ] 应能导出分析报告

### 6. 前端显示与用户体验测试

#### 6.1 实验创建表单的用户体验

**目标**: 验证实验创建表单的用户体验是否良好

**步骤**:
1. 使用研究者账户登录
2. 访问实验创建表单
3. 测试表单的各个功能和交互

**验证点**:
- [ ] 表单应有清晰的分步指引
- [ ] 必填字段应有明确标记
- [ ] 应有输入验证，防止无效数据
- [ ] 文件上传应有进度指示和预览
- [ ] 表单应支持保存草稿
- [ ] 提交前应有确认步骤

#### 6.2 实验详情页面的响应式设计

**目标**: 验证实验详情页面在不同设备上的显示效果

**步骤**:
1. 使用浏览器开发者工具模拟不同设备尺寸
2. 检查实验详情页面的布局和元素排列

**验证点**:
- [ ] 页面应在桌面、平板和手机尺寸下正常显示
- [ ] 图片和图表应适应屏幕大小
- [ ] 操作按钮应有合适的大小，便于在移动设备上操作
- [ ] 长文本内容应有适当的折叠或分页

#### 6.3 数据可视化效果

**目标**: 验证数据可视化效果是否直观清晰

**步骤**:
1. 访问包含图表和数据可视化的页面
2. 检查各种图表的显示效果和交互性

**验证点**:
- [ ] 图表应清晰展示数据趋势和关系
- [ ] 应有适当的标签和图例
- [ ] 图表应支持交互（如悬停显示详情）
- [ ] 图表应能适应不同的数据量
- [ ] 配色方案应考虑色盲用户的可访问性

## 测试数据记录表

| 测试用例 | 测试日期 | 测试结果 | 问题描述 | 修复状态 |
|---------|---------|---------|---------|---------|
| 1.1 基本实验创建 | | | | |
| 1.2 带资金目标的实验创建 | | | | |
| 1.3 带数据集的实验创建 | | | | |
| 2.1 编辑实验信息 | | | | |
| 2.2 添加实验结果 | | | | |
| 2.3 管理数据访问权限 | | | | |
| 3.1 实验列表浏览 | | | | |
| 3.2 实验搜索功能 | | | | |
| 3.3 实验详情页面 | | | | |
| 4.1 购买数据访问权 | | | | |
| 4.2 访问已购买的数据 | | | | |
| 4.3 数据 NFT 验证 | | | | |
| 5.1 研究者仪表板统计 | | | | |
| 5.2 单个实验分析 | | | | |
| 6.1 实验创建表单的用户体验 | | | | |
| 6.2 实验详情页面的响应式设计 | | | | |
| 6.3 数据可视化效果 | | | | |

## 测试结果汇总

在完成所有测试后，请在此处汇总测试结果:

- 总测试用例数: 17
- 通过测试用例数: 
- 失败测试用例数: 
- 通过率: 

## 问题与建议

请在此处记录测试过程中发现的问题和改进建议:

1. [问题描述]
   - 严重程度: [高/中/低]
   - 复现步骤: [步骤]
   - 预期结果: [预期]
   - 实际结果: [实际]
   - 建议修复方案: [建议]
