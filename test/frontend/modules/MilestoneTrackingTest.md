# 里程碑与进度跟踪测试计划

本文档详细描述了如何测试 DeSciData 平台的里程碑与进度跟踪功能，确保这些功能在前端正确实现并与智能合约正确集成。

## 测试前提

- 已部署 DeSciData 智能合约，包含里程碑跟踪功能
- 前端服务器正在运行
- 准备了测试账户（项目管理员、研究者、普通用户）
- 已初始化了 3 个阶段、9 个里程碑的项目结构

## 测试用例

### 1. 里程碑显示功能测试

#### 1.1 项目进度概览页面

**目标**: 验证进度概览页面正确显示所有项目阶段和里程碑

**步骤**:
1. 使用任意账户登录
2. 访问 `http://localhost:3000/dashboard/progress`
3. 检查页面内容

**验证点**:
- [ ] 页面应显示 3 个项目阶段（基础设施与核心功能、功能扩展、生态系统与可扩展性）
- [ ] 每个阶段应显示其包含的里程碑
- [ ] 每个里程碑应显示名称、当前进度和目标进度
- [ ] 应显示整体项目进度百分比
- [ ] 页面应有清晰的视觉指示器（如进度条或图表）

#### 1.2 单个阶段详情页面

**目标**: 验证单个阶段详情页面正确显示该阶段的所有里程碑和 KPI

**步骤**:
1. 从进度概览页面点击任一阶段（如"基础设施与核心功能"）
2. 检查阶段详情页面内容

**验证点**:
- [ ] 页面应显示该阶段的所有里程碑（如 MS 1.1、MS 1.2、MS 1.3）
- [ ] 每个里程碑应显示详细信息，包括：
  - 名称和描述
  - 当前进度和目标进度
  - 关联的 KPI 及其当前值/目标值
- [ ] 应显示该阶段的整体进度百分比
- [ ] 对于项目管理员，应显示更新进度的操作按钮

### 2. 里程碑更新功能测试

#### 2.1 更新里程碑进度

**目标**: 验证项目管理员能够更新里程碑的完成进度

**步骤**:
1. 使用项目管理员账户登录
2. 访问 `http://localhost:3000/dashboard/progress`
3. 选择一个阶段，进入阶段详情页面
4. 找到"更新进度"按钮并点击
5. 在弹出的表单中：
   - 选择要更新的里程碑（如 MS 1.1：用户系统与认证）
   - 输入新的进度值（如 75%）
   - 提交表单
6. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 里程碑的进度应更新为新值
- [ ] 包含该里程碑的阶段的整体进度应相应更新
- [ ] 更新历史应记录此次更改

#### 2.2 更新里程碑 KPI

**目标**: 验证项目管理员能够更新里程碑的 KPI 值

**步骤**:
1. 使用项目管理员账户登录
2. 访问里程碑详情页面
3. 找到"更新 KPI"按钮并点击
4. 在弹出的表单中：
   - 选择要更新的 KPI（如 MS 1.1 的"已连接钱包数量"）
   - 输入新的当前值（如 2）
   - 提交表单
5. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] KPI 的当前值应更新为新值
- [ ] 如果 KPI 达到目标值，应有视觉指示
- [ ] 更新历史应记录此次更改

#### 2.3 权限控制测试

**目标**: 验证只有项目管理员能够更新里程碑和 KPI

**步骤**:
1. 使用非项目管理员账户（如普通研究者）登录
2. 访问 `http://localhost:3000/dashboard/progress`
3. 检查是否有更新进度和更新 KPI 的按钮
4. 尝试通过 API 直接调用更新功能

**验证点**:
- [ ] 非管理员用户不应看到更新按钮
- [ ] 如果尝试通过 API 直接调用更新功能，应返回权限错误
- [ ] 前端应有明确的提示，说明只有项目管理员可以更新进度

### 3. 阶段进度计算测试

#### 3.1 阶段进度自动计算

**目标**: 验证阶段进度是否正确计算为其包含的所有里程碑的平均进度

**步骤**:
1. 使用项目管理员账户登录
2. 更新某一阶段（如阶段 1）的多个里程碑进度：
   - MS 1.1: 80%
   - MS 1.2: 60%
   - MS 1.3: 40%
3. 检查阶段 1 的整体进度

**验证点**:
- [ ] 阶段 1 的整体进度应为 60%（三个里程碑进度的平均值）
- [ ] 进度条或其他视觉指示器应正确反映这一百分比
- [ ] 如果更新其中一个里程碑的进度，阶段进度应自动重新计算

#### 3.2 项目整体进度计算

**目标**: 验证项目整体进度是否正确计算

**步骤**:
1. 使用项目管理员账户设置各阶段里程碑的不同进度
2. 访问 `http://localhost:3000/dashboard/progress`
3. 检查项目整体进度

**验证点**:
- [ ] 项目整体进度应为所有里程碑进度的加权平均值
- [ ] 进度计算应考虑各阶段的权重（如果有）
- [ ] 整体进度应在仪表板上明显显示

### 4. 里程碑创建功能测试

#### 4.1 创建新里程碑

**目标**: 验证项目管理员能够创建新的里程碑

**步骤**:
1. 使用项目管理员账户登录
2. 访问 `http://localhost:3000/dashboard/progress`
3. 找到"创建里程碑"按钮并点击
4. 在弹出的表单中填写：
   - 里程碑 ID（如 MS 4.1）
   - 名称（如"社区参与"）
   - 描述
   - 关联阶段（如选择阶段 3）
   - KPI 列表（如"社区成员数量"，目标值 100）
5. 提交表单
6. 在 MetaMask 中确认交易

**验证点**:
- [ ] 表单应成功提交
- [ ] 交易成功后应显示确认消息
- [ ] 新里程碑应出现在选定阶段的里程碑列表中
- [ ] 新里程碑的初始进度应为 0%
- [ ] 关联的 KPI 应正确显示

#### 4.2 创建里程碑的 gas 消耗验证

**目标**: 验证创建里程碑的 gas 消耗是否在预期范围内

**步骤**:
1. 使用项目管理员账户创建新里程碑
2. 记录交易的 gas 消耗

**验证点**:
- [ ] 创建里程碑的 gas 消耗应在约 255,000 gas 左右
- [ ] 交易应在合理时间内完成
- [ ] 如果 gas 消耗明显高于预期，应记录为潜在问题

### 5. 前端显示与用户体验测试

#### 5.1 进度可视化效果

**目标**: 验证进度的可视化效果是否直观清晰

**步骤**:
1. 访问进度概览页面和各阶段详情页面
2. 检查进度条、图表或其他可视化元素

**验证点**:
- [ ] 进度可视化应直观反映完成情况
- [ ] 颜色编码应清晰（如绿色表示完成，黄色表示进行中，红色表示延迟）
- [ ] 应能一目了然地看出项目、阶段和里程碑的进度状态
- [ ] 可视化元素应有适当的标签和说明

#### 5.2 里程碑详情页面的响应式设计

**目标**: 验证里程碑详情页面在不同设备上的显示效果

**步骤**:
1. 使用浏览器开发者工具模拟不同设备尺寸
2. 检查里程碑详情页面的布局和元素排列

**验证点**:
- [ ] 页面应在桌面、平板和手机尺寸下正常显示
- [ ] 复杂的进度图表应适应小屏幕（可能通过简化或滚动方式）
- [ ] 文本和按钮应有合适的大小，便于在移动设备上操作
- [ ] 不应出现水平滚动条或元素溢出

#### 5.3 更新操作的用户体验

**目标**: 验证更新里程碑和 KPI 的操作流程是否流畅

**步骤**:
1. 使用项目管理员账户执行多次更新操作
2. 评估操作的便捷性和反馈及时性

**验证点**:
- [ ] 更新表单应简洁明了，只包含必要字段
- [ ] 应有实时验证，防止输入无效数据
- [ ] 提交后应有明确的加载状态指示
- [ ] 操作成功或失败应有清晰的反馈
- [ ] 对于批量更新，应提供便捷的界面

### 6. 集成测试

#### 6.1 里程碑更新与项目状态集成

**目标**: 验证里程碑进度更新是否正确影响项目整体状态

**步骤**:
1. 使用项目管理员账户将某一关键里程碑（如 MS 3.1：众筹）的进度更新为 100%
2. 检查项目仪表板和相关功能页面

**验证点**:
- [ ] 项目仪表板应反映里程碑完成状态
- [ ] 如果该里程碑与特定功能相关（如众筹功能），该功能的状态应更新为"可用"
- [ ] 项目时间线应标记该里程碑为已完成

#### 6.2 里程碑数据导出功能

**目标**: 验证里程碑和进度数据是否可以导出为报告

**步骤**:
1. 访问 `http://localhost:3000/dashboard/progress`
2. 找到"导出报告"按钮并点击
3. 选择导出格式（如 PDF 或 CSV）
4. 下载报告

**验证点**:
- [ ] 报告应成功生成和下载
- [ ] 报告应包含所有阶段、里程碑和 KPI 的当前状态
- [ ] 数据应格式化为易读的形式
- [ ] 报告应包含生成日期和时间

## 测试数据记录表

| 测试用例 | 测试日期 | 测试结果 | 问题描述 | 修复状态 |
|---------|---------|---------|---------|---------|
| 1.1 项目进度概览页面 | | | | |
| 1.2 单个阶段详情页面 | | | | |
| 2.1 更新里程碑进度 | | | | |
| 2.2 更新里程碑 KPI | | | | |
| 2.3 权限控制测试 | | | | |
| 3.1 阶段进度自动计算 | | | | |
| 3.2 项目整体进度计算 | | | | |
| 4.1 创建新里程碑 | | | | |
| 4.2 创建里程碑的 gas 消耗验证 | | | | |
| 5.1 进度可视化效果 | | | | |
| 5.2 里程碑详情页面的响应式设计 | | | | |
| 5.3 更新操作的用户体验 | | | | |
| 6.1 里程碑更新与项目状态集成 | | | | |
| 6.2 里程碑数据导出功能 | | | | |

## 测试结果汇总

在完成所有测试后，请在此处汇总测试结果:

- 总测试用例数: 14
- 通过测试用例数: 
- 失败测试用例数: 
- 通过率: 

## 问题与建议

请在此处记录测试过程中发现的问题和改进建议:

1. [问题描述]
   - 严重程度: [高/中/低]
   - 复现步骤: [步骤]
   - 预期结果: [预期]
   - 实际结果: [实际]
   - 建议修复方案: [建议]
